import{H as O,n as E,s as B,x as Z,q as i,o as D,y as $,w as n,b as e,a as r,c as q,F as G,z as H,u as l,t as h,r as P,B as X,C as j,D as J,E as U,d as F,V as K,G as Q}from"./entry.ee28b950.js";import{h as y}from"./index.89ded283.js";import{u as k,_ as W}from"./Error.vue.49b1e664.js";import{u as S}from"./fetch.23709f3e.js";const M=O("inscription",{state:()=>({currentCourse:null,inscriptions:[],showForm:!1,loading:!1,current:null,showConfirm:!1}),actions:{async getCourseById(a){const{data:o}=await S(`/api/course/${a}`,"$aUtzL72O18");this.currentCourse=o.value},async getAllByCourse(){const{data:a}=await S(`/api/inscription/${this.currentCourse._id}`,"$ve3Rnt2hzZ");this.inscriptions=a.value.data},async create(a){const o=k();this.loading=!0;const{data:c,error:d}=await S("/api/inscription",{method:"POST",body:a},"$2gmNLljEIb");if(this.loading=!1,d.value){o.setError(d.value.statusMessage);return}this.showForm=!1,this.inscriptions.push(c.value)},async update(a){const o=k();this.loading=!0;const{data:c,error:d}=await S("/api/inscription",{method:"PATCH",body:a},"$5Dh9q4kvkT");if(this.loading=!1,d.value){o.setError(d.value.statusMessage);return}this.showForm=!1,this.inscriptions=this.inscriptions.map(f=>f._id===a._id?c.value:f)},async delete(a){this.loading=!0,await S(`/api/inscription/delete/${a}`,{method:"DELETE"},"$Oi6BUwItgv"),this.inscriptions=this.inscriptions.filter(o=>o._id!==a),this.loading=!1,this.showConfirm=!1},setShowForm(a){this.showForm=a},setCurrent(a){this.current=a},setShowConfirm(a){this.showConfirm=a}},getters:{inscriptionsReportXLSX(a){return a.inscriptions.map(o=>({nombre:o.name,fechaNacimiento:y(o.birdthDate).format("DD-MM-YYYY"),direccion:o.address,zona:o.zone,sexo:o.sexo,telefono:o.phone,cedula:o.cedula}))}}}),ee=r("thead",null,[r("tr",null,[r("th",null,"Nombre"),r("th",null,"Fecha nacimiento"),r("th",null,"Zona"),r("th",null,"Dirección"),r("th",null,"Telefono"),r("th",null,"Cédula"),r("th",null,"Sexo"),r("th",null,"Acciones")])],-1),se=E({__name:"TableInscription",async setup(a){let o,c;const d=M(),{inscriptions:f}=B(d);[o,c]=Z(()=>d.getAllByCourse()),await o,c();const m=t=>{d.setCurrent(t),d.setShowForm(!0)},b=t=>{d.setCurrent(t),d.setShowConfirm(!0)};return(t,p)=>{const v=i("VBtn"),g=i("VTable"),C=i("VCard");return D(),$(C,{elevation:"5"},{default:n(()=>[e(g,null,{default:n(()=>[ee,r("tbody",null,[(D(!0),q(G,null,H(l(f),s=>(D(),q("tr",null,[r("td",null,h(s.name),1),r("td",null,h(l(y)(s.birdthDate).format("DD/MM/YYYY")),1),r("td",null,h(s.zone),1),r("td",null,h(s.address),1),r("td",null,h(s.phone),1),r("td",null,h(s.cedula),1),r("td",null,h(s.sexo),1),r("td",null,[e(v,{icon:"mdi-eye",color:"warning",variant:"text",title:"Editar",onClick:u=>m(s)},null,8,["onClick"]),e(v,{icon:"mdi-delete",color:"error",variant:"text",title:"Eliminar",onClick:u=>b(s)},null,8,["onClick"])])]))),256))])]),_:1})]),_:1})}}}),te=r("div",null,"Masculino",-1),ne=r("div",null,"Femenino",-1),ie=E({__name:"FormInscription",setup(a){const o=P(null),c=M(),d=k(),{loading:f,current:m,currentCourse:b}=B(c),t=X({name:"",birdthDate:"",zone:"urbana",address:"",phone:"",cedula:"",sexo:"M"}),p={required:[s=>!!s||"Campo requerido!"],min:[s=>!!s&&s.length===10||"Debe tener 10 dígitos"]},v=j(()=>m.value?"Editar":"Agregar"),g=async()=>{const{valid:s}=await o.value.validate();s&&(m.value?await c.update({...t,birdthDate:y(t.birdthDate).utc().valueOf(),sexo:t.sexo,_id:m.value._id,_course:b.value._id}):await c.create({...t,_course:b.value._id,birdthDate:y(t.birdthDate).utc().valueOf(),sexo:t.sexo}))},C=()=>{c.setShowForm(!1)};return J(()=>{m.value&&(t.name=m.value.name,t.birdthDate=y(m.value.birdthDate).format("YYYY-MM-DD"),t.address=m.value.address,t.cedula=m.value.cedula,t.zone=m.value.zone,t.sexo=m.value.sexo,t.phone=m.value.phone)}),U(()=>{c.setCurrent(null),d.resetError()}),(s,u)=>{const T=i("VCardTitle"),V=i("VCol"),w=i("VRow"),I=W,x=i("VTextField"),A=i("VSelect"),Y=i("v-radio"),N=i("v-radio-group"),z=i("VBtn"),R=i("VCardText"),L=i("VCard");return D(),$(L,{elevation:"5"},{default:n(()=>[e(w,null,{default:n(()=>[e(V,null,{default:n(()=>[e(T,{class:"text-center text-h4"},{default:n(()=>[F(h(l(v))+" Inscripción ",1)]),_:1})]),_:1})]),_:1}),e(R,null,{default:n(()=>[e(l(K),{ref_key:"formRef",ref:o,onSubmit:Q(g,["prevent"])},{default:n(()=>[e(w,null,{default:n(()=>[e(V,null,{default:n(()=>[e(I)]),_:1})]),_:1}),e(w,null,{default:n(()=>[e(V,null,{default:n(()=>[e(x,{modelValue:l(t).name,"onUpdate:modelValue":u[0]||(u[0]=_=>l(t).name=_),variant:"outlined",label:"Nombre",rules:p.required},null,8,["modelValue","rules"])]),_:1}),e(V,null,{default:n(()=>[e(x,{type:"date",modelValue:l(t).birdthDate,"onUpdate:modelValue":u[1]||(u[1]=_=>l(t).birdthDate=_),variant:"outlined",label:"Fecha de nacimiento",rules:p.required},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(w,null,{default:n(()=>[e(V,null,{default:n(()=>[e(x,{modelValue:l(t).cedula,"onUpdate:modelValue":u[2]||(u[2]=_=>l(t).cedula=_),variant:"outlined",label:"Cédula",rules:[...p.required,...p.min]},null,8,["modelValue","rules"])]),_:1}),e(V,null,{default:n(()=>[e(x,{type:"tel",modelValue:l(t).phone,"onUpdate:modelValue":u[3]||(u[3]=_=>l(t).phone=_),variant:"outlined",label:"Teléfono",rules:[...p.required,...p.min]},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(w,null,{default:n(()=>[e(V,null,{default:n(()=>[e(A,{modelValue:l(t).zone,"onUpdate:modelValue":u[4]||(u[4]=_=>l(t).zone=_),variant:"outlined",items:["urbana","rural"],label:"Zona",rules:p.required},null,8,["modelValue","rules"])]),_:1}),e(V,null,{default:n(()=>[e(x,{modelValue:l(t).address,"onUpdate:modelValue":u[5]||(u[5]=_=>l(t).address=_),variant:"outlined",label:"Direccion",rules:p.required},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(N,{inline:"",modelValue:l(t).sexo,"onUpdate:modelValue":u[6]||(u[6]=_=>l(t).sexo=_)},{label:n(()=>[F(" Sexo ")]),default:n(()=>[e(Y,{value:"M"},{label:n(()=>[te]),_:1}),e(Y,{value:"F"},{label:n(()=>[ne]),_:1})]),_:1},8,["modelValue"]),e(z,{class:"mt-4",variant:"tonal",type:"submit",loading:l(f),block:"",color:"primary",text:"Guardar"},null,8,["loading"]),e(z,{class:"mt-2",variant:"tonal",disabled:l(f),color:"error",block:"",onClick:C,text:"Cancelar"},null,8,["disabled"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})}}}),ue=E({__name:"ConfirmInscription",setup(a){const o=M(),{current:c,loading:d}=B(o),f=()=>{o.setShowConfirm(!1)},m=async()=>{await o.delete(c.value._id)};return U(()=>{o.setCurrent(null)}),(b,t)=>{const p=i("VCardTitle"),v=i("VCardText"),g=i("VSpacer"),C=i("VBtn"),s=i("VCardActions"),u=i("VCard");return D(),$(u,null,{default:n(()=>[e(p,{class:"text-center"},{default:n(()=>[F(" Eliminar Inscripción ")]),_:1}),e(v,null,{default:n(()=>{var T;return[F(" ¿Estás seguro de eliminar la inscripción de "+h((T=l(c))==null?void 0:T.name)+"? ",1)]}),_:1}),e(s,null,{default:n(()=>[e(g),e(C,{variant:"tonal",text:"Cancelar",onClick:f,disabled:l(d),color:"error"},null,8,["disabled"]),e(C,{variant:"tonal",text:"Confirmar",onClick:m,loading:l(d),color:"primary"},null,8,["loading"])]),_:1})]),_:1})}}});export{se as _,ie as a,ue as b,M as u};
